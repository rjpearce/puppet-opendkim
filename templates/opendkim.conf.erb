###########################################################################
# Puppet managed file
###########################################################################
# This is a basic configuration that can easily be adapted to suit a standard
# Sign for example.com with key in /etc/mail/dkim.key using
# installation. For more advanced options, see opendkim.conf(5) and/or
# /usr/share/doc/opendkim/examples/opendkim.conf.sample.

# Log to syslog
<% if @syslog != false %>Syslog <%= @syslog %><% end %>
<% if @syslog_success != false %>SyslogSuccess <%= @syslog_success %><% end %>
# Required to use local socket with MTAs that access the socket as a non-
# privileged user (e.g. Postfix)
<% if @umask != false %>UMask <%= @umask %><% end %>

# Commonly-used options; the commented-out versions show the defaults.
#Canonicalization	simple
#Mode			sv
#SubDomains		no
#ADSPDiscard		no

# Always oversign From (sign using actual From and a null From to prevent
# malicious signatures header fields (From and/or others) between the signer
# and the verifier.  From is oversigned by default in the Debian pacakge
# because it is often the identity key used by reputation systems and thus
# somewhat security sensitive.
<% if @oversignheaders != false %>OversignHeaders <%= @oversignheaders %><% end %>

InternalHosts <%= @internalhosts.join(',') %>

# List domains to use for RFC 6541 DKIM Authorized Third-Party Signatures
# (ATPS) (experimental)
#ATPSDomains		example.com

<% @additional_parameters.each do | key, value| -%>
   <%- if ( value.is_a? Array ) -%>
<%= key.ljust(20,' ') %>  <%= value.join(',') %>
   <%- else -%>
<%= key.ljust(20,' ') %>  <%= value %>
   <%- end -%>
<% end -%>

# Sign for example.com with key in /etc/mail/dkim.key using
# selector '2007' (e.g. 2007._domainkey.example.com)
